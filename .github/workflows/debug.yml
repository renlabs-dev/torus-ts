# .github/workflows/debug.yml
name: Check Changes

on:
  push:
  pull_request:

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Check if before commit exists
        run: |
          if git rev-parse --quiet --verify ${{ github.event.before }}^{commit}; then
            echo "Before commit exists "
          else
            echo "Before commit does not exist"
          fi

      - name: Check merge-base
        run: |
          if git merge-base ${{ github.event.before }} HEAD; then
            echo "Before commit exists"
          else
            echo "Before commit does not exist"
          fi

      - uses: ./.github/actions/check-turbo-changes
        id: changes

      # Simple conditional steps
      - name: Build torus-wallet
        if: steps.changes.outputs.torus-wallet == 'true'
        run: echo "Building torus-wallet..."

      - name: Build torus-page
        if: steps.changes.outputs.torus-page == 'true'
        run: echo "Building torus-page..."

      # Debug output
      - name: Show changes
        run: |
          # Print all outputs
          echo "All changes:"
          echo '${{ toJSON(steps.changes.outputs) }}' | jq '.'
