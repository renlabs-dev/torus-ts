# .github/workflows/torus-validator.yml
name: torus-validator

on:
  workflow_dispatch:
  push:
    paths-ignore:
      - "apps/torus-worker/**"
      - "apps/torus-governance/**"
      - "apps/torus-page/**"
      - "apps/torus-bridge/**"
      - "apps/torus-wallet/**"
      - "apps/torus-cache/**"

jobs:
  kubernetes:
    if: github.ref_name == 'main' || github.ref_name == 'dev' || github.ref_name == 'cicd'
    uses: ./.github/workflows/app-deployment-template.yml
    with:
      app_name: torus-validator
    secrets:
      VAULT_ADDR: ${{ secrets.VAULT_ADDR }}
      VAULT_ROLE_ID: ${{ secrets.VAULT_ROLE_ID }}
      VAULT_SECRET_ID: ${{ secrets.VAULT_SECRET_ID }}

  dry-run-build:
    if: github.ref_name != 'main' && github.ref_name != 'dev' && github.ref_name != 'cicd'
    uses: ./.github/workflows/dry-run-build-template.yml
    with:
      app_name: torus-validator
