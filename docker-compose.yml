services:

  subspace:
    image: subspace:local-main
    command: bash -c "/subspace/extra/insert-authority-keys.sh; /subspace/extra/run-node.sh"
    environment:
      SUBSPACE_BASE_PATH: /subspace/node-data
      SUBSPACE_CHAIN_SPEC: /subspace/specs/local.json
      SUBSPACE_ACCOUNT: alice
      PORT: 30341
      RPC_PORT: 9951
    ports:
      - 9951:9951
    volumes:
      - subspace-data:/subspace/node-data
      - ./data/chain-specs:/subspace/specs:ro
      - ./docker/subspace-extra:/subspace/extra:ro

  # postgres:
  #   image: postgres:16-alpine
  #   ports:
  #     - 5432:5432
  #   volumes:
  #     - db-data:/var/lib/postgresql/data
  #   environment:
  #     - POSTGRES_PASSWORD=password
  #     - POSTGRES_USER=postgres
  #     - POSTGRES_DB=torus-ts-db

  # torus-cache:
  #   build:
  #     context: .
  #     dockerfile: tooling/dockerfile/backend-service.Dockerfile
  #     args:
  #       - PROJECT=torus-cache
  #   environment:
  #     - NEXT_PUBLIC_WS_PROVIDER_URL=${NEXT_PUBLIC_WS_PROVIDER_URL}
  #     - PORT=8000
  #   command: npm start
  #   ports:
  #     - 3011:8000

  # torus-worker:
  #   depends_on:
  #     - postgres
  #   build:
  #     context: .
  #     dockerfile: tooling/dockerfile/backend-service.Dockerfile
  #     args:
  #       - PROJECT=torus-worker
  #   environment:
  #     - NEXT_PUBLIC_WS_PROVIDER_URL=${NEXT_PUBLIC_WS_PROVIDER_URL}
  #     - POSTGRES_URL=postgres://postgres:password@postgres:5432/torus-ts-db
  #     - PORT=8000
  #   ports:
  #     - 3012:8000
  #   command: npm start

  # torus-validator:
  #   build:
  #     context: .
  #     dockerfile: docker/Dockerfile
  #     args:
  #       APP_NAME: torus-validator

  # torus-governance:
  #   build:
  #     context: .
  #     dockerfile: docker/Dockerfile
  #     args:
  #       APP_NAME: torus-governance

  # torus-page:
  #   build:
  #     context: .
  #     dockerfile: docker/Dockerfile
  #     args:
  #       APP_NAME: torus-page

volumes:
  subspace-data:
  db-data:
